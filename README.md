# Distributed Systems Project
### NTUA ECE 9th semester 2023- 2024

#### Contributors:
* **Theodora Boutsini** 03119094
* **Georgios Babanis** 03119083
* **Evangelos Kontiannis** 01319104

### [Project Description](./DistributedProject2024.pdf)

### Project Implementation
#### [Node](src/main/java/gr/ntua/blockchainService/Node.java)
Το σύστημα μας αποτελείται από πανομοιότυπους κόμβους , εκτός του bootstrap που έχει κάποια επιπλεόν λειτουργικότητα μόνο κατά
την εκκίνηση και έπειτα συμπεριφέρεται ακριβώς όπως όλοι οι υπόλοιποι. 
Κάθε κόμβος έχει το wallet του, το Blockchain, το nonce του(αύξων αριθμών των transaction που
έχει δημιουργήσει ο κόμβος για να αποφύγουμε replay attacks), μια λίστα NodeInfo με την 
κατάσταση του δικτύου και ένα instance της communication κλάσης ώστε να επικοινωνεί με τους υπόλοιπους κόμβους.

#### [Wallet](src/main/java/gr/ntua/blockchainService/Wallet.java)
Περιέχει το private και το public key του κόμβου και έχει την δυνατότητα να transactions.

#### [Transaction](src/main/java/gr/ntua/blockchainService/Wallet.java)
Κάθε transaction περιέχει το πόσο και το μήνυμα που μεταφέρεται, τα public keys του αποστολέα 
και παραλήπτη, το μέγεθος του fee που χρεώνει ο validator, το hash και την υπογραφή του αποστολέα.

#### Blockchain
Μια λίστα από blocks που περιλαμβάνει όλες τις καταγεγραμμένες έγκυρες συναλλαγές.

#### [Block](src/main/java/gr/ntua/blockchainService/Block.java)
Περιέχει ένα index με τη θέση του στο blockchain, το hash του, το hash του προηγούμενου block, το id του validator, την ώρα
έκδοσης του block και τη λίστα με τα transactions που περιέχει.

#### [Nodeinfo](src/main/java/gr/ntua/blockchainService/NodeInfo.java)
Περιέχει πληροφορίες για το state του κάθε κόμβου όπως το stake και το balance. Μέσω 
αυτής της κλάσης γίνεται ο έλεγχος nonce όταν καταγράφεται μία συναλλαγή για την 
αποφυγή replay attacks.

#### Εξωτερικές βιβλιοθήκες
Για την δημιουργία hash, keys, signature και τους αντίστοιχους ελέγχους χρησιμοποιήθηκε
η κλάση java.security. Για την ψευδοτυχαία συνάρτηση χρησιμοποιήθηκε η συνάρτηση Arrays.hashcode
που αποδίδει έναν ακέραιο σε κάποιο hash με ντετερμινιστικό τρόπο.

#### Αρχές λειτουργίας
Κάθε κόμβος έχει τη δυνατότητα να δημιουργήσει μιά συναλλαγή στην οποία είτε δεσμεύει stake
είτε να στείλει μήνυμα ή ποσό σε άλλο κόμβο. Κάθε μία από αυτές τις συναλλαγές γίνονται broadcast 
στο δίκτυο. Τότε η συναλλαγή μπαίνει στη λίστα pending transactions του κάθε κόμβου. Αν 
ο κόμβος είναι σε λειτουργία validator αδειάζει αυτή τη λίστα, βάζοντας transactions στο 
block που δημιουργεί. Παράλληλα ελέγχει αν η συναλλαγή είναι έγκυρη και ενημερώνει την εικόνα
της κατάστασης του δικτύου. Όταν γεμίσει το block, το κάνει mint, broadcast στο δίκτυο και έπειτα
ελέγχει με βάση τα stake και την ψευδοτυχαία συνάρτηση αν είναι ο validator του επόμενου 
block και μπαίνει στην κατάλληλη λειτουργία και βάζει το block στο blockchain. Οι κόμβοι σε λειτουργία receiver περιμένουν μέχρι
να παραλάβουν ένα block. Όταν γίνει αυτό, αν το block έχει μεγαλύτερο index από που περιμένει, το
αφήνει στην άκρη μέχρι να έρθει η σειρά του. Τη στιγμή που έρθει το block με το αναμενόμενο 
index ελέγχεται η εγκυρότητα του, έπειτα ενημερώνεται η κατάσταση του δικτύου και εισέρχεται
το block στο blockchain. Τώρα τα transactions που έχουν μπει στο block βγαίνουν από την pending transactions λίστα.
Τέλος, καλείται η ψευδοτυχαία συνάρτηση ώστε να μπει ο κόμβος σε κατάλληλη λειτουργία. Άκυρα transactions
και blocks δεν επηρεάζουν τη λειτουργία και απλά παραλείπονται. Ο σχεδιασμός αυτός δεν είναι 
ανθεκτικός σε crash κόμβων και κακόβουλους validator.

#### Εκκίνηση του δικτύου
Κατά την εκκίνηση του δικτύου ο bootstrap είναι ο πρώτος που συνδέεται και γνωρίζει το συνολικό αριθμό 
κόμβων που πρέπει να συνδεθούν. Όταν τελειώσει η σύνδεση των κόμβων ο bootstrap στέλνει μήνυμα σε όλους
επιτρέποντας την εκκίνηση συναλλαγών. 


### Deployment
